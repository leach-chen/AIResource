
# ä¸€ã€æ¨¡å‹è½¬æ¢

## ğŸ“± ç§»åŠ¨ç«¯éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”


| æ–¹æ¡ˆæŠ€æœ¯æ ˆ | æ¨¡å‹è½¬æ¢è·¯å¾„ | æ¨ç†å¼•æ“ | æ ¸å¿ƒä¼˜ç‚¹ | æ ¸å¿ƒç¼ºç‚¹/æŒ‘æˆ˜ | æ¨èç»™... |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **OpenCV DNN** | è®­ç»ƒæ¨¡å‹ -> **ONNX** | **OpenCV DNNæ¨¡å—** (C++ API) | **1. é›†æˆç®€å•**ï¼šOpenCVæ˜¯è®¡ç®—æœºè§†è§‰æ ‡é…ï¼Œæ— éœ€é¢å¤–å¼•å…¥å¤§å‹åº“ã€‚<br>**2. è·¨å¹³å°**ï¼šä»£ç å¯åœ¨Androidã€iOSã€Windowsã€Linuxé—´å¤ç”¨ã€‚<br>**3. é¢„å¤„ç†ä¾¿åˆ©**ï¼šä¸OpenCVå›¾åƒæ“ä½œæ— ç¼è¡”æ¥ã€‚ | **1. åç«¯æ”¯æŒæœ‰é™**ï¼šç§»åŠ¨ç«¯GPUåŠ é€Ÿï¼ˆVulkanï¼‰æ”¯æŒä¸ç¨³å®šï¼Œæ€§èƒ½é€šå¸¸ä¸å¦‚ä¸“ç”¨å¼•æ“ã€‚<br>**2. ç®—å­æ”¯æŒä¸å…¨**ï¼šå¯¹æ–°ç‰ˆæ¨¡å‹çš„æŸäº›ç‰¹æ®Šç®—å­æ”¯æŒå¯èƒ½æ»åã€‚<br>**3. åå¤„ç†å…¨æ‰‹åŠ¨**ï¼šéœ€å®Œå…¨è‡ªå·±å®ç°è¾“å‡ºè§£æï¼Œé—¨æ§›é«˜ã€‚ | é¡¹ç›®å·²é‡åº¦ä¾èµ–OpenCVï¼›è¿›è¡Œå¿«é€ŸåŸå‹éªŒè¯ï¼›è¿½æ±‚ä»£ç åœ¨å¤šä¸ªå¹³å°é—´çš„æœ€å¤§å¤ç”¨æ€§ã€‚ |
| **ONNX + ONNX Runtime** | è®­ç»ƒæ¨¡å‹ -> **ONNX** | **ONNX Runtime** (C++ API) | **1. æ€§èƒ½ä¼˜åŒ–å¥½**ï¼šä¸“ä¸ºONNXä¼˜åŒ–ï¼Œæ¨ç†é€Ÿåº¦é€šå¸¸ä¼˜äºOpenCV DNNã€‚<br>**2. æ ‡å‡†ä¸å…¼å®¹æ€§**ï¼šå¾®è½¯å®˜æ–¹ç»´æŠ¤ï¼Œç®—å­æ”¯æŒå…¨é¢ï¼Œç‰ˆæœ¬æ›´æ–°å¿«ã€‚<br>**3. ç¡¬ä»¶åŠ é€Ÿ**ï¼šé€šè¿‡`ExecutionProvider`æ”¯æŒNNAPIã€CoreMLç­‰ï¼Œæ½œåŠ›å¤§ã€‚ | **1. åº“ä½“ç§¯è¾ƒå¤§**ï¼šéœ€è¦é¢å¤–é›†æˆã€‚<br>**2. åå¤„ç†æ‰‹åŠ¨**ï¼šä¸OpenCV DNNä¸€æ ·ï¼Œéœ€è‡ªè¡Œè§£æè¾“å‡ºã€‚ | å¸Œæœ›åšæŒONNXæ ‡å‡†ï¼Œå¹¶è¿½æ±‚æ¯”OpenCV DNNæ›´ä½³æ€§èƒ½å’Œå¯é æ€§çš„é¡¹ç›®ã€‚ |
| **TFLite + TFLite Runtime** | è®­ç»ƒæ¨¡å‹ -> ONNX -> **TFLite** | **TensorFlow Lite** (C++ API) | **1. ç¡¬ä»¶åŠ é€Ÿæœ€ä½³**ï¼šé€šè¿‡`Delegate`æœºåˆ¶ï¼ˆGPUã€NNAPIã€è‡ªç ”NPUï¼‰æ”¯æŒæä½³ã€‚<br>**2. å·¥å…·é“¾å®Œå–„**ï¼šå®˜æ–¹æä¾›é‡åŒ–ã€è£å‰ªã€è°ƒè¯•å…¨å¥—å·¥å…·ã€‚<br>**3. ç”Ÿæ€å¼ºå¤§**ï¼šç¤¾åŒºèµ„æºã€é¢„è®­ç»ƒæ¨¡å‹ä¸°å¯Œã€‚ | **1. è½¬æ¢é“¾ç•¥é•¿**ï¼šå¤šä¸€æ­¥è½¬æ¢ï¼Œå¯èƒ½å¼•å…¥å…¼å®¹æ€§é—®é¢˜ã€‚<br>**2. åå¤„ç†æ‰‹åŠ¨**ï¼šä»éœ€è‡ªè¡Œå®ç°ã€‚ | è¿½æ±‚æœ€å¹¿æ³›çš„ç¡¬ä»¶å…¼å®¹æ€§å’Œæè‡´æ€§èƒ½ï¼›æ„¿æ„æ¥å—è°·æ­ŒæŠ€æœ¯æ ˆã€‚ |
| **ä¸“ç”¨æ¡†æ¶ (NCNN/MNN)** | è®­ç»ƒæ¨¡å‹ -> **NCNN/MNNæ ¼å¼** | **NCNN** æˆ– **MNN** (C++ API) | **1. ç§»åŠ¨ç«¯æè‡´ä¼˜åŒ–**ï¼šæ¶æ„ä¸“ä¸ºç§»åŠ¨ç«¯è®¾è®¡ï¼Œä½“ç§¯å°ã€é€Ÿåº¦å¿«ã€‚<br>**2. ç¤¾åŒºç¤ºä¾‹ä¸°å¯Œ**ï¼šå°¤å…¶æ˜¯NCNNï¼Œæœ‰å¤§é‡YOLOçš„**å®Œæ•´C++å®ç°**ï¼ˆå«åå¤„ç†ï¼‰ã€‚<br>**3. ä¸­æ–‡æ”¯æŒå¥½**ï¼šç”±å›½å†…å…¬å¸ç»´æŠ¤ï¼Œæ–‡æ¡£å’Œç¤¾åŒºæ²Ÿé€šä¾¿åˆ©ã€‚ | **1. ç»‘å®šç‰¹å®šæ¡†æ¶**ï¼šéœ€ä½¿ç”¨å…¶è½¬æ¢å·¥å…·å’ŒAPIã€‚<br>**2. ç”Ÿæ€ç›¸å¯¹é›†ä¸­**ï¼šä¸»è¦é›†ä¸­åœ¨CVé¢†åŸŸã€‚ | **å¼ºçƒˆæ¨èç»™å—å›°äºåå¤„ç†çš„ä½ **ï¼šå¯å¿«é€Ÿæ‰¾åˆ°å¼€ç®±å³ç”¨çš„å‚è€ƒä»£ç ï¼Œæå¤§èŠ‚çœå¼€å‘æ—¶é—´ã€‚ |
| **åŸæ¡†æ¶è¿è¡Œæ—¶ (LibTorch)** | è®­ç»ƒæ¨¡å‹ -> **TorchScript** | **LibTorch** (PyTorch C++) | **1. å¼€å‘ä½“éªŒä¸€è‡´**ï¼šAPIä¸PyTorch Pythonç‰ˆå‡ ä¹ç›¸åŒï¼Œè°ƒè¯•æ–¹ä¾¿ã€‚<br>**2. é›¶è½¬æ¢æŸå¤±**ï¼šæ— éœ€æ‹…å¿ƒè½¬æ¢å¯¼è‡´çš„ç²¾åº¦æˆ–ç®—å­ä¸¢å¤±é—®é¢˜ã€‚ | **1. åº“ä½“ç§¯å·¨å¤§**ï¼ˆ~100MB+ï¼‰ï¼Œä¸¥é‡å½±å“APKå¤§å°ã€‚<br>**2. ç§»åŠ¨ç«¯æ€§èƒ½éæœ€ä¼˜**ï¼ŒåŠŸè€—è¾ƒé«˜ã€‚ | ç”¨äºå¿«é€ŸéªŒè¯æ¨¡å‹åœ¨ç§»åŠ¨ç«¯çš„å¯è¡Œæ€§ï¼›æˆ–æ¨¡å‹ä½¿ç”¨äº†æå…¶ç‰¹æ®Šã€éš¾ä»¥è½¬æ¢çš„ç®—å­ã€‚ |




```
NCNN:
https://gitee.com/guolun/ncnn-yolov8-android/blob/master/README.md
https://blog.csdn.net/DoraemonCat520/article/details/139472947
https://convertmodel-1256200149.cos-website.ap-nanjing.myqcloud.com/
https://www.bilibili.com/opus/1076081443060318248
https://blog.csdn.net/wanggao_1990/article/details/146007121

```


## ğŸ”„ Yoloæ¨¡å‹è½¬æ¢

### è½¬ONNX
yolo export model=xxx format=onnx imgsz=640 opset=17 simplify=True dynamic=False batch=1




# äºŒã€ç§»åŠ¨ç«¯é›†æˆ


## Android C++é¡¹ç›®é›†æˆOpenCV

1ï¼šåˆ›å»ºAndroid C++é¡¹ç›®

2ï¼šä¸‹è½½Android SDKï¼ˆOpenCV â€“ 4.12.0ï¼‰ https://opencv.org/releases/?aliasId=l10B6XvDlABIGHJ2I

3ï¼šè§£å‹ä¸‹è½½çš„SDKï¼Œå°†ç›®å½•ä¸‹çš„sdkç›®å½•é€šè¿‡import moduleæ–¹å¼å¯¼å…¥åˆ°Androidé¡¹ç›®ä¸­,å¯¼å…¥çš„moduleæœ€å¥½è¿˜æ˜¯ä»¥sdkä½œä¸ºåç§°ï¼Œå¦åˆ™åé¢ç¼–è¯‘å¯èƒ½æŠ¥é”™

**CMakeLists.txté…ç½®**
```
cmake_minimum_required(VERSION 3.22.1)

project("dartrecognitionandroid")

# æŒ‡å‘ openCVLibrary æ¨¡å—ä¸­çš„ jni ç›®å½•ï¼ˆåŒ…å« OpenCVConfig.cmakeï¼‰
set(OpenCV_DIR "xxx\\DartRecognitionAndroid\\sdk\\native\\jni")

# æŸ¥æ‰¾ OpenCV åŒ…
find_package(OpenCV REQUIRED)

# æ·»åŠ å¹¶é“¾æ¥åº“
add_library(dartrecognitionandroid SHARED native-lib.cpp DartLineCVModel.cpp)
target_link_libraries(dartrecognitionandroid ${OpenCV_LIBS} android log jnigraphics)
```


**åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶æ–‡æœ¬ç»™åˆ°Androidå±•ç¤º**
```

#include <jni.h>
#include <string>
#include <android/bitmap.h>
#include <opencv2/opencv.hpp>

extern "C"
JNIEXPORT jbyteArray JNICALL
Java_com_leach_dartrecognitionandroid_MainActivity_predict(JNIEnv *env, jobject clazz,jobject imageData) {

    // è·å–Javaç±»å’Œå­—æ®µID
    jclass cls = env->GetObjectClass(imageData);
    jfieldID fidWidth = env->GetFieldID(cls, "width", "I");
    jfieldID fidHeight = env->GetFieldID(cls, "height", "I");
    jfieldID fidChannels = env->GetFieldID(cls, "channels", "I");
    jfieldID fidData = env->GetFieldID(cls, "data", "[B");
    jfieldID fidLineModelPath = env->GetFieldID(cls, "lineModelPath", "Ljava/lang/String;");

    // æå–å­—æ®µå€¼
    int width = env->GetIntField(imageData, fidWidth);
    int height = env->GetIntField(imageData, fidHeight);
    int channels = env->GetIntField(imageData, fidChannels);
    jbyteArray data = (jbyteArray)env->GetObjectField(imageData, fidData);
    jstring jlineModelPath = (jstring)env->GetObjectField(imageData, fidLineModelPath);

    // å°†Javaå­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºC++æŒ‡é’ˆ
    jbyte* cData = env->GetByteArrayElements(data, nullptr);

    const char* lineModelPath = env->GetStringUTFChars(jlineModelPath, nullptr);

    // åˆ›å»ºcv::Matå¯¹è±¡ (ARGBæ ¼å¼)
    cv::Mat inputMat(height, width, CV_8UC4, (unsigned char*)cData);

    // è½¬æ¢é¢œè‰²ç©ºé—´ (OpenCVä½¿ç”¨BGRï¼ŒAndroidä½¿ç”¨ARGB)
    cv::Mat bgrMat;
    cv::cvtColor(inputMat, bgrMat, cv::COLOR_RGBA2BGR);

    // åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶æ–‡æœ¬
    cv::putText(bgrMat,
                "123",
                cv::Point(50, 100),
                cv::FONT_HERSHEY_SIMPLEX,
                2.0,
                cv::Scalar(0, 0, 255),
                3,
                cv::LINE_AA);

    // è½¬æ¢å›RGBAæ ¼å¼ä»¥ä¾¿åœ¨Androidä¸­æ­£ç¡®æ˜¾ç¤º
    cv::Mat resultMat;
    cv::cvtColor(bgrMat, resultMat, cv::COLOR_BGR2RGBA);


    // åˆ›å»ºè¿”å›çš„byteæ•°ç»„
    jbyteArray result = env->NewByteArray(resultMat.total() * resultMat.elemSize());
    env->SetByteArrayRegion(result, 0, resultMat.total() * resultMat.elemSize(),
                            (jbyte*)resultMat.data);

    // é‡Šæ”¾èµ„æº
    env->ReleaseByteArrayElements(data, cData, JNI_ABORT);
    env->ReleaseStringUTFChars(jlineModelPath,lineModelPath);

    return result;
}
```


## NCNNé›†æˆ

1ï¼šä¸‹è½½ncnnç§»åŠ¨ç«¯åº“ https://github.com/Tencent/ncnn?tab=readme-ov-fileï¼Œ
è§£å‹å¤åˆ¶åˆ°é¡¹ç›®çš„cppç›®å½•ä¸‹ï¼Œä¸è¦æ”¹ä»»ä½•æ–‡ä»¶ä»¥åŠä»£ç 

2ï¼šptæ¨¡å‹onnxè½¬ncnnæ ¼å¼

**yolo export model=DartLine.pt format=onnx imgsz=640 opset=12 simplify=True dynamic=False batch=1 nms=False half=False device=cpu**
```
https://guo-pu.blog.csdn.net/article/details/142942825

 
# export_onnx.py
from ultralytics import YOLO
import sys

def export_yolo_to_onnx(model_path, output_path="yolo_export.onnx"):
    """
    å°†YOLOæ¨¡å‹å¯¼å‡ºä¸ºONNXæ ¼å¼
    
    å‚æ•°:
        model_path: PyTorchæ¨¡å‹è·¯å¾„ (.pt)
        output_path: è¾“å‡ºONNXæ–‡ä»¶è·¯å¾„
    """
    print(f"æ­£åœ¨åŠ è½½æ¨¡å‹: {model_path}")
    
    # åŠ è½½YOLOæ¨¡å‹
    model = YOLO(model_path)
    
    # è·å–æ¨¡å‹ä¿¡æ¯
    print(f"æ¨¡å‹ç±»åˆ«æ•°: {model.model.nc}")
    print(f"æ¨¡å‹è¾“å…¥å°ºå¯¸: {model.model.args.get('imgsz', 640)}")
    
    # å¯¼å‡ºONNX
    print(f"æ­£åœ¨å¯¼å‡ºONNXåˆ°: {output_path}")
    
    success = model.export(
        format='onnx',
        imgsz=640,           # è¾“å…¥å›¾åƒå°ºå¯¸
        opset=12,            # ONNX opsetç‰ˆæœ¬ï¼ˆ12æœ€ç¨³å®šï¼‰
        simplify=True,       # ç®€åŒ–æ¨¡å‹
        dynamic=False,       # å›ºå®šè¾“å…¥å°ºå¯¸ï¼ˆç§»åŠ¨ç«¯æ¨èï¼‰
        batch=1,             # æ‰¹å¤§å°è®¾ä¸º1
        nms=False,           # ä¸åŒ…å«NMSï¼ˆé‡è¦ï¼ï¼‰
        half=False,          # ä¸ä½¿ç”¨FP16ï¼ˆç¡®ä¿å…¼å®¹æ€§ï¼‰
        workspace=4,         # GPUå·¥ä½œç©ºé—´ï¼ˆGBï¼‰
        device='cpu',        # åœ¨CPUä¸Šå¯¼å‡ºç¡®ä¿å…¼å®¹æ€§
        verbose=True         # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
    )
    
    if success:
        print(f"âœ… ONNXå¯¼å‡ºæˆåŠŸ: {output_path}")
        return output_path
    else:
        print("âŒ ONNXå¯¼å‡ºå¤±è´¥")
        return None

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # ä½ çš„æ¨¡å‹è·¯å¾„
    pt_model = "DartLine.pt"
    onnx_output = "DartLine.onnx"
    
    export_yolo_to_onnx(pt_model, onnx_output)
```

**ç®€åŒ–ONNXæ¨¡å‹**

pip install onnxsim

python -m onnxsim DartLine.onnx DartLine-sim.onnx

```
# éªŒè¯ç®€åŒ–åçš„æ¨¡å‹
python -c "
import onnx
model = onnx.load('DartLine-sim.onnx')
onnx.checker.check_model(model)
print('âœ… ONNXæ¨¡å‹ç®€åŒ–æˆåŠŸ')
print(f'è¾“å…¥: {model.graph.input[0].name}')
print(f'è¾“å‡º: {model.graph.output[0].name}')
"
```

**è½¬æ¢åˆ°ncnnæ ¼å¼**

onnx2ncnn ./DartLine-sim.onnx ./DartLine.param ./DartLine.bin



**pnnx DartLine1.onnx**

æ³¨ï¼šå¦‚æœæ‰§è¡Œpnnxè½¬æ¢æ—¶æŠ¥é”™OMP: Error #15: Initializing libiomp5md.dll, but found libiomp5md.dll already initialized.è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºç¨‹åºä¸­æœ‰å¤šä¸ªOpenMPè¿è¡Œæ—¶åº“è¢«åˆå§‹åŒ–ã€‚é€šå¸¸å‘ç”Ÿåœ¨é“¾æ¥äº†å¤šä¸ªåŒ…å«OpenMPçš„åº“ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½è¯•å›¾åˆå§‹åŒ–è‡ªå·±çš„OpenMPè¿è¡Œæ—¶ç¯å¢ƒã€‚å»ºè®®ç”¨conda/anacondaåˆ›å»ºè¿‡ä¸€ä¸ªç¯å¢ƒï¼Œå†ç”¨pnnxè½¬

```
inputshape = [batch_size, channels, height, width]
# ç¤ºä¾‹ï¼š[1, 3, 224, 224]
# batch_size = 1    # ä¸€æ¬¡å¤„ç†1å¼ å›¾
# channels = 3      # RGBä¸‰é€šé“
# height = 224      # å›¾åƒé«˜åº¦224åƒç´ 
# width = 224       # å›¾åƒå®½åº¦224åƒç´ 


# PNNXå¸®åŠ©ä¿¡æ¯
pnnx --help
# å¸¸è§å‚æ•°ï¼š
pnnx mobile.onnx \
  inputshape=[1,3,224,224] \    # è¾“å…¥å½¢çŠ¶ï¼ˆå¯é€‰ï¼‰
  inputshape2=[1,4] \           # å¤šè¾“å…¥å½¢çŠ¶
  device=cpu \                  # è¿è¡Œè®¾å¤‡ï¼šcpu/gpu
  optlevel=2 \                  # ä¼˜åŒ–çº§åˆ«ï¼š0-2
  fp16=1 \                      # æ˜¯å¦ä½¿ç”¨FP16ï¼š0/1
  use_f16=1 \                   # åŒä¸Š
  use_fp16_storage=1 \          # å­˜å‚¨ä½¿ç”¨FP16
  customop=./customop.def \     # è‡ªå®šä¹‰æ“ä½œå®šä¹‰
  moduleop=./moduleop.def \     # æ¨¡å—æ“ä½œå®šä¹‰
  pnnxparam=./param.par \       # PNNXå‚æ•°æ–‡ä»¶
  pnnxbin=./model.bin \         # PNNXæƒé‡æ–‡ä»¶
  pnnxpy=./model.py \           # ç”ŸæˆPythonæ¥å£
  pnnxonnx=./model.onnx \       # ç”ŸæˆONNXæ–‡ä»¶
  ncnnparam=./model.ncnn.param \# è¾“å‡ºNCNNç»“æ„
  ncnnbin=./model.ncnn.bin \    # è¾“å‡ºNCNNæƒé‡
  ncnnpy=./model_ncnn.py        # è¾“å‡ºNCNN Pythonæ¥å£


è¿è¡ŒPNNXè½¬æ¢ï¼š
å¦‚æœONNXæ¨¡å‹è¾“å…¥æ˜¯é™æ€çš„ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼špnnx mobile.onnx
å¦‚æœæ˜¯åŠ¨æ€çš„ï¼Œè¿è¡Œï¼špnnx mobile.onnx inputshape=[x,x,x,x]


æŸ¥çœ‹æ¨¡å‹ä¿¡æ¯
pip install netron
netron DartLine.pt

æ‰“å¼€æ¨¡å‹åï¼Œç‚¹å‡»ä»»æ„è¾“å…¥/è¾“å‡ºèŠ‚ç‚¹ï¼Œåœ¨å³ä¾§å±æ€§é¢æ¿æŸ¥çœ‹shape
åˆ¤æ–­æ–¹æ³•ï¼š
å¦‚æœçœ‹åˆ°å…·ä½“æ•°å­—ï¼š[1, 3, 224, 224] â†’ é™æ€ç»´åº¦
å¦‚æœçœ‹åˆ°?æˆ–Noneï¼š[?, 3, ?, ?] â†’ åŠ¨æ€ç»´åº¦
å¦‚æœçœ‹åˆ°ç¬¦å·åï¼š[batch, 3, height, width] â†’ åŠ¨æ€ç»´åº¦
```


3ï¼šåŒæ—¶é›†æˆopencvå’Œncnnä¼šæŠ¥ç¼–è¯‘å†²çªé—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¯å‚è€ƒ

https://gitee.com/luo_zhi_cheng/awesome-ncnn/blob/master/FAQ.md

https://github.com/Tencent/ncnn/issues/3231

**é‡æ–°ç¼–è¯‘ncnn**

```
windows
1ï¼šgit clone https://github.com/Tencent/ncnn.git
cd ncnn
git submodule update --init

2ï¼šä¸‹è½½NDKï¼Œé…ç½®ç¯å¢ƒå˜é‡
# open $ANDROID_NDK/build/cmake/android.toolchain.cmake for ndk < r23
# or $ANDROID_NDK/build/cmake/android-legacy.toolchain.cmake for ndk >= r23
# delete "-g" line
list(APPEND ANDROID_COMPILER_FLAGS
  -g
  -DANDROID


3ï¼šä¸‹è½½Ninjaï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼šhttps://github.com/ninja-build/ninja/releases

4ï¼šcmake -G "Ninja" -DCMAKE_TOOLCHAIN_FILE="F:/Install/StudySoftware/AndroidSdk/ndk/26.1.10909125/build/cmake/android.toolchain.cmake" -DANDROID_ABI="arm64-v8a" -DANDROID_ARM_NEON=ON -DANDROID_PLATFORM=android-14 -DNCNN_VULKAN=ON -DNCNN_DISABLE_EXCEPTION=OFF -DNCNN_DISABLE_RTTI=OFF ..
#armeabi-v7a
#arm64-v8a
ninja install

5ï¼šå°†ç¼–è¯‘å‡ºæ¥çš„ç›®å½•ä¸‹çš„includeç›®å½•é‡Œé¢çš„æ–‡ä»¶æ‹·è´åˆ°é¡¹ç›®é‡Œå¯¹åº”çš„arm64-v8aã€armeabi-v7aã€x86_64ã€x86ç›®å½•ä¸‹

6ï¼šCmakeLists.txté…ç½®
cmake_minimum_required(VERSION 3.22.1)

project("dartrecognitionandroid")

# æŒ‡å‘ openCVLibrary æ¨¡å—ä¸­çš„ jni ç›®å½•ï¼ˆåŒ…å« OpenCVConfig.cmakeï¼‰
set(OpenCV_DIR "xxx\\DartRecognitionAndroid\\sdk\\native\\jni")

# æŸ¥æ‰¾ OpenCV åŒ…
find_package(OpenCV REQUIRED)

# è®¾ç½® NCNN å®‰è£…ç›®å½•
set(ncnn_DIR ${CMAKE_SOURCE_DIR}/ncnn-20250916-android-vulkan/${ANDROID_ABI}/lib/cmake/ncnn)
find_package(ncnn REQUIRED)

## æ‰“å°å¯ç”¨å˜é‡æ¥è°ƒè¯•
#message(FATAL_ERROR "ncnn_DIR: ${ncnn_DIR}")


# æ·»åŠ å¹¶é“¾æ¥åº“
add_library(dartrecognitionandroid SHARED native-lib.cpp DartLineCVModel.cpp Constants.cpp YOLOv11Detector.cpp)


target_link_libraries(dartrecognitionandroid ${OpenCV_LIBS} ncnn android log jnigraphics)

```

æ¨¡å‹ä¼˜åŒ–
```
# ä½¿ç”¨ncnnoptimizeä¼˜åŒ–æ¨¡å‹
./ncnnoptimize model.param model.bin model-opt.param model-opt.bin 65536

# ä½¿ç”¨FP16é‡åŒ–ï¼ˆå‡å°æ¨¡å‹å¤§å°ï¼‰
./ncnnoptimize model.param model.bin model-opt-fp16.param model-opt-fp16.bin 65536

# ä½¿ç”¨INT8é‡åŒ–ï¼ˆæœ€å¤§å‹ç¼©ï¼‰
./ncnn2int8 model.param model.bin model-int8.param model-int8.bin calib.table
```


https://blog.csdn.net/QQ_1309399183/article/details/149009894
https://blog.csdn.net/weixin_34471637/article/details/156463071